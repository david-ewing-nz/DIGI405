\documentclass[12pt]{article}
\usepackage{fontspec}
\setmainfont{TeX Gyre Termes}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{geometry}
\geometry{margin=0.6in, top=0.4in, bottom=-1.9in}

\usepackage{parskip}
\setlength{\parskip}{0.3em}
\setlength{\parindent}{0pt}

\pagestyle{empty}

\begin{document}

\noindent
\textbf{Mean-Field Factorisation Strategy}

\vspace{0.2em}

\textit{Mean-field variational inference imposes conditional independence on the posterior to enable tractable inference. The key is to factor parameters according to their coupling structure in the likelihood.}

\vspace{2\baselineskip}

\noindent
\textbf{Full joint posterior:}

\begin{align*}
p(\beta, u, \tau_u, \tau_e \mid y) &\propto p(y \mid \beta, u, \tau_e)\, p(u \mid \tau_u)\, p(\beta)\, p(\tau_u)\, p(\tau_e) \\
\intertext{\noindent\textbf{Mean-field factorisation:}}
q(\beta, u, \tau_u, \tau_e) &= q(\beta, u) \cdot q(\tau_u) \cdot q(\tau_e)
\end{align*}

\vspace{2\baselineskip}

\textit{This factorisation preserves the coupling between $\beta$ and $u$ in the likelihood, while separating the precision parameters to admit conjugate Gamma updates.}

\vspace{2\baselineskip}

\noindent
\textbf{Coordinate Ascent Updates}

\vspace{0.15em}

\begin{align*}
\intertext{\noindent\textbf{Regression block:} \textit{$p(\beta, u \mid y, \tau_u, \tau_e)$ is Gaussian, so $q(\beta, u)$ is Gaussian:}}
\Sigma_{\beta u}^{\text{new}} &= \left[ X^T X\, \mathbb{E}[\tau_e] + \operatorname{diag}(\Gamma_\beta^{-1}, \mathbb{E}[\tau_u]\, \mathbf{1}_u) \right]^{-1} \\
\mu_{\beta u}^{\text{new}} &= \Sigma_{\beta u}^{\text{new}}\, X^T y\, \mathbb{E}[\tau_e] \\
\intertext{\noindent\textbf{Residual precision:} \textit{$p(\tau_e \mid y, \beta, u)$ is Gamma, so $q(\tau_e)$ is Gamma:}}
a_e^{\text{new}} &= a_e + \tfrac{n}{2} \\
b_e^{\text{new}} &= b_e + \tfrac{1}{2}\mathbb{E}[(y - X\beta - Zu)^T(y - X\beta - Zu)] \\
\intertext{\noindent\textbf{Random-effects precision:} \textit{$p(\tau_u \mid u)$ is Gamma, so $q(\tau_u)$ is Gamma:}}
a_u^{\text{new}} &= a_u + \tfrac{Q}{2} \\
b_u^{\text{new}} &= b_u + \tfrac{1}{2}\mathbb{E}[u^T u] \\
\intertext{\textit{All expectations are computed using current variational parameters. The loop repeats until ELBO convergence.}}
\end{align*}

\end{document}
